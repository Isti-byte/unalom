<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pong Multiplayer</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="startMenu" class="menu">
  <div class="menu-content">
    <h1>PONG</h1>
    <p>Select Game Mode</p>
    <button id="onePlayerBtn" class="start-button">1 PLAYER (vs AI)</button>
    <button id="twoPlayerBtn" class="start-button">2 PLAYERS</button>
  </div>
</div>

<div id="gameContainer" class="container" style="display:none;">
  <div class="left-section">
    <canvas id="player1Canvas" width="100" height="500" class="player-canvas"></canvas>
  </div>
  <div class="center-section">
    <div class="controls-info">
      <h2 id="gameMode">2 Players</h2>
      <h3>Controls</h3>
      <p><strong>Player 1 (Left):</strong> W/S keys</p>
      <p id="player2Controls"><strong>Player 2 (Right):</strong> Arrow Up/Down keys</p>
      <button id="stopBtn">Stop Game</button>
      <button id="resumeBtn" style="display:none;">Resume Game</button>
      <button id="menuBtn">Back to Menu</button>
    </div>
    <canvas id="pong" width="800" height="500"></canvas>
  </div>
  <div class="right-section">
    <canvas id="player2Canvas" width="100" height="500" class="player-canvas"></canvas>
  </div>
</div>

<script>
  const canvas = document.getElementById("pong");
  const ctx = canvas.getContext("2d");
  const player1Canvas = document.getElementById("player1Canvas");
  const player1Ctx = player1Canvas.getContext("2d");
  const player2Canvas = document.getElementById("player2Canvas");
  const player2Ctx = player2Canvas.getContext("2d");
  
  let isPaused = false;
  let gameIntervalId;
  let isSinglePlayer = false;

  const paddleWidth = 10, paddleHeight = 100;

  // Player Model Class
  class Player {
    constructor(x, color) {
      this.x = x;
      this.y = canvas.height / 2 - paddleHeight / 2;
      this.width = paddleWidth;
      this.height = paddleHeight;
      this.dy = 0;
      this.score = 0;
      this.color = color;
    }

    reset() {
      this.y = canvas.height / 2 - paddleHeight / 2;
      this.dy = 0;
      this.score = 0;
    }

    update() {
      this.y += this.dy;
      this.y = Math.max(0, Math.min(canvas.height - this.height, this.y));
    }

    draw(ctx) {
      ctx.fillStyle = this.color;
      ctx.fillRect(this.x, this.y, this.width, this.height);
    }
  }

  const player1 = new Player(canvas.width - paddleHeight, "white");
  const player2 = new Player(canvas.width - paddleWidth, "white");

  const ball = {
    x: canvas.width/2,
    y: canvas.height/2,
    radius: 8,
    speed: 5,
    dx: 5,
    dy: 5
  };

  function drawRect(x, y, w, h, color) {
    ctx.fillStyle = color;
    ctx.fillRect(x, y, w, h);
  }

  function drawCircle(x, y, r, color) {
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.arc(x, y, r, 0, Math.PI * 2);
    ctx.closePath();
    ctx.fill();
  }

  function drawText(text, x, y, color) {
    ctx.fillStyle = color;
    ctx.font = "32px Arial";
    ctx.fillText(text, x, y);
  }

  function resetBall() {
    ball.x = canvas.width/2;
    ball.y = canvas.height/2;
    ball.dx = -ball.dx;
    ball.speed = 5;
  }

  function drawNet() {
    for (let i = 0; i < canvas.height; i += 15) {
      drawRect(canvas.width/2 - 1, i, 2, 10, "white");
    }
  }

  function update() {
    player1.update();
    if (!isSinglePlayer) {
      player2.update();
    } else {
      updateAI();
      player2.update();
    }

    ball.x += ball.dx;
    ball.y += ball.dy;

    if (ball.y - ball.radius < 0 || ball.y + ball.radius > canvas.height) {
      ball.dy = -ball.dy;
    }

    let paddle = (ball.x < canvas.width / 2) ? player1 : player2;

    if (
      ball.x - ball.radius < paddle.x + paddle.width &&
      ball.x + ball.radius > paddle.x &&
      ball.y < paddle.y + paddle.height &&
      ball.y > paddle.y
    ) {
      let collidePoint = ball.y - (paddle.y + paddle.height / 2);
      collidePoint = collidePoint / (paddle.height / 2);
      let angle = collidePoint * Math.PI / 4;
      let direction = (ball.x < canvas.width / 2) ? 1 : -1;

      ball.dx = direction * ball.speed * Math.cos(angle);
      ball.dy = ball.speed * Math.sin(angle);
      ball.speed += 0.5;
    }

    if (ball.x - ball.radius < 0) {
      player2.score++;
      resetBall();
    } else if (ball.x + ball.radius > canvas.width) {
      player1.score++;
      resetBall();
    }
  }

  function updateAI() {
    const paddleCenter = player2.y + player2.height / 2;
    const ballCenter = ball.y;
    const difficulty = 4;
    
    if (paddleCenter < ballCenter - 35) {
      player2.dy = difficulty;
    } else if (paddleCenter > ballCenter + 35) {
      player2.dy = -difficulty;
    } else {
      player2.dy = 0;
    }
  }
  function render() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawNet();
    
    ctx.font = "16px Arial";
    drawText("Player 1", canvas.width / 4 - 30, 30, "white");
    ctx.font = "32px Arial";
    drawText(player1.score, canvas.width / 4, 60, "white");
    
    ctx.font = "16px Arial";
    drawText("Player 2", 3 * canvas.width / 4 - 30, 30, "white");
    ctx.font = "32px Arial";
    drawText(player2.score, 3 * canvas.width / 4, 60, "white");
    
    player1.draw(ctx);
    player2.draw(ctx);
    drawCircle(ball.x, ball.y, ball.radius, "white");

    // Render Player 1 Canvas
    player1Ctx.clearRect(0, 0, player1Canvas.width, player1Canvas.height);
    player1Ctx.fillStyle = "#111";
    player1Ctx.fillRect(0, 0, player1Canvas.width, player1Canvas.height);
    player1Ctx.fillStyle = "white";
    player1Ctx.font = "14px Arial";
    player1Ctx.fillText("P1", 35, 20);
    player1Ctx.font = "32px Arial";
    player1Ctx.fillText(player1.score, 30, 60);

    // Render Player 2 Canvas
    player2Ctx.clearRect(0, 0, player2Canvas.width, player2Canvas.height);
    player2Ctx.fillStyle = "#111";
    player2Ctx.fillRect(0, 0, player2Canvas.width, player2Canvas.height);
    player2Ctx.fillStyle = "white";
    player2Ctx.font = "14px Arial";
    player2Ctx.fillText("P2", 35, 20);
    player2Ctx.font = "32px Arial";
    player2Ctx.fillText(player2.score, 30, 60);
  }

  function gameLoop() {
    if (!isPaused) {
      update();
      render();
    }
  }

  gameIntervalId = setInterval(gameLoop, 1000 / 60);
  
  const stopBtn = document.getElementById("stopBtn");
  const resumeBtn = document.getElementById("resumeBtn");
  const menuBtn = document.getElementById("menuBtn");
  const onePlayerBtn = document.getElementById("onePlayerBtn");
  const twoPlayerBtn = document.getElementById("twoPlayerBtn");
  const startMenu = document.getElementById("startMenu");
  const gameContainer = document.getElementById("gameContainer");
  const gameMode = document.getElementById("gameMode");
  const player2Controls = document.getElementById("player2Controls");
  
  function startGame(singlePlayer) {
    isSinglePlayer = singlePlayer;
    gameMode.textContent = singlePlayer ? "1 Player vs AI" : "2 Players";
    player2Controls.style.display = singlePlayer ? "none" : "block";
    startMenu.style.display = "none";
    gameContainer.style.display = "flex";
  }
  
  function goToMenu() {
    isPaused = false;
    gameContainer.style.display = "none";
    startMenu.style.display = "flex";
    stopBtn.style.display = "block";
    resumeBtn.style.display = "none";
    player1.reset();
    player2.reset();
    resetBall();
  }
  
  onePlayerBtn.addEventListener("click", () => startGame(true));
  twoPlayerBtn.addEventListener("click", () => startGame(false));
  menuBtn.addEventListener("click", goToMenu);
  
  stopBtn.addEventListener("click", () => {
    isPaused = true;
    stopBtn.style.display = "none";
    resumeBtn.style.display = "block";
  });
  
  resumeBtn.addEventListener("click", () => {
    isPaused = false;
    stopBtn.style.display = "block";
    resumeBtn.style.display = "none";
  });

  const keys = {};

  document.addEventListener("keydown", (e) => {
    keys[e.key] = true;
    if (keys["w"]) player1.dy = -6;
    if (keys["s"]) player1.dy = 6;
    if (keys["ArrowUp"]) player2.dy = -6;
    if (keys["ArrowDown"]) player2.dy = 6;
  });

  document.addEventListener("keyup", (e) => {
    keys[e.key] = false;
    if (e.key === "w" || e.key === "s") player1.dy = 0;
    if (e.key === "ArrowUp" || e.key === "ArrowDown") player2.dy = 0;
  });
</script>
</body>
</html>